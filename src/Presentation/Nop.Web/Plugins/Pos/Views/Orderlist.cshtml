@using Nop.Core.Domain.Customers;

@using Nop.Core.Domain.Orders;
@*@using Nop.Plugins.Pos.Models;*@
@using Nop.Services.Customers;
@{
    Layout = "~/Views/Shared/_ColumnsOne.cshtml";
}

@inject ICustomerService _customerService
@model IEnumerable<Order>

@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@*we remove the default InputTagHelper to prevent the checkbox duplicating: https://stackoverflow.com/questions/42544961/asp-net-core-custom-input-tag-helper-rendering-duplicate-checkboxes*@
@removeTagHelper Microsoft.AspNetCore.Mvc.TagHelpers.InputTagHelper, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, Nop.Web.Framework
@addTagHelper *, MiniProfiler.AspNetCore.Mvc

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4-4.6.0/jq-3.6.0/dt-1.13.1/b-2.3.3/fc-4.2.1/sc-2.0.7/sb-1.4.0/sp-2.1.0/sl-1.5.0/datatables.min.css" />

<script src="~/js/admin.table.js" asp-location="Footer"></script>
<script type="text/javascript" src="https://cdn.datatables.net/v/bs4-4.6.0/jq-3.6.0/dt-1.13.1/b-2.3.3/fc-4.2.1/sc-2.0.7/sb-1.4.0/sp-2.1.0/sl-1.5.0/datatables.min.js"></script>




<style>
    .gotocart {
        border: 0;
        background-color: #4ab2f1;
        padding: 9px;
        font-size: 14px;
        color: #fff;
        text-transform: uppercase;
        align-items: center;
        display: inline-flex;
    }

    .inputbutton {
        height: 36px;
        border: 1px solid #ddd;
        padding: 8px;
        vertical-align: middle;
    }

    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }


    /* Firefox */
    input[type=number] {
        -moz-appearance: textfield;
    }
</style>
<h2> Search By </h2>
<br />
<div class="container">
    <form asp-controller="Pos">
        <input type="radio" id="OrderNumber" name="Search1" class="OrderNumberClass" value="OrderNumber">
        <label for="OrderNumber">Order Number</label>

        <input type="radio" id="CustomerName" name="Search2" class="CustomerNameClass" value="CustomerName">
        <label for="CustomerName">Customer Name</label>

        <input type="radio" id="CustomerEmail" name="Search3" class="CustomerEmailClass" value="CustomerEmail">
        <label for="CustomerEmail">Customer Email</label>

        <br />

        <input type="text" class="inputbutton" id="SearchValue" name="SearchValue">
        <button asp-action="OrderList" asp-controller="Pos" type="submit" class="gotocart" id="searchvalue">Search Order</button>
    </form>
</div>

<div>
</div>

<hr />

<form asp-controller="Pos">

    @if (Model.Count() != 0)
    {
        <div>
            <table id="myTable" class="cart table table-bordered table-sm" width="100%">
                <thead class="hidden-xs">
                    <tr class="border border-1 cart-header-row">
                        <th>
                            Order Number
                        </th>
                        <th>
                            Customer Name
                        </th>
                        <th>
                            Order Status
                        </th>
                        <th>
                            Payment Status
                        </th>
                        <th>
                            Shipping Status
                        </th>
                        <th>
                            Created on
                        </th>
                        <th>
                            Total Amount
                        </th>
                        <th>
                            Order Details
                        </th>
                    </tr>
                </thead>

                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr class="border border-1 cart-header-row">
                            <td>
                                @item.CustomOrderNumber
                            </td>
                            <td>
                                @{
                                    var customerdetails = _customerService.GetCustomerByIdAsync(item.CustomerId).Result;
                                    var name = customerdetails.FirstName;
                                }
                                @name
                            </td>
                            <td>
                                @item.OrderStatus
                            </td>
                            <td>
                                @item.PaymentStatus
                            </td>
                            <td>
                                @item.ShippingStatus
                            </td>
                            <td>
                                @item.CreatedOnUtc.Date
                            </td>
                            <td>
                                @item.OrderTotal
                            </td>
                            <td>
                                <button asp-action="Details" asp-controller="Pos" type="submit" class="gotocart" asp-route-orderId="@item.Id">Details</button>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

    }

    else
    {
        <p>No Records Found</p>
    }

</form>


<script>
    $(document).ready(function () {
        $('#myTable').DataTable({
            "scrolly": "450px",
            "scrollCollapse": true,
            "paging": true,
            "lengthChange": false,
            "pageLength": 5,
            "order": [[0, 'desc']],
            "searching": false,
            "language": {
                "zeroRecords": "No Record Found"
            },
            'autoWidth': true
        });
    });
</script>


<script>

    var OrderNumberField = document.getElementById("OrderNumber");
    var CustomerNameField = document.getElementById("CustomerName");
    var CustomerEmailField = document.getElementById("CustomerEmail");
    var SearchBoxField = document.getElementById("SearchValue");


    OrderNumberField.onclick = function () {
        CustomerNameField.checked = false;
        CustomerEmailField.checked = false;
        SearchBoxField.type = "number";
    }

    CustomerNameField.onclick = function () {
        OrderNumberField.checked = false;
        CustomerEmailField.checked = false;
        SearchBoxField.type = "text";

    }


    CustomerEmailField.onclick = function () {
        CustomerNameField.checked = false;
        OrderNumberField.checked = false;
        SearchBoxField.type = "email";

    }

</script>

